box:
  id: quay.io/tatsuya6502/rustbook
  tag: latest
  registry: quay.io

dev:
  steps:
    - install-packages:
        packages: xz-utils
    - script:
        name: build the book
        code: |
          make RUSTBOOK=/root/.cargo/bin/rustbook

build:
  steps:
    - install-packages:
        packages: xz-utils
    - script:
        name: build the book
        code: |
          make RUSTBOOK=/root/.cargo/bin/rustbook
    - script:
        name: make tarballs
        code: |
          tar cJf public-1.6.txz public/1.6
          tar cJf public-1.9.txz public/1.9
    - script:
        name: save artifacts [Download]
        code: |
          cp public-*.txz $WERCKER_REPORT_ARTIFACTS_DIR
